<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Linear regression | Quantitative Methods for Geographers</title>
  <meta name="description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Linear regression | Quantitative Methods for Geographers" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  <meta name="github-repo" content="krueger-t/qm4g" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Linear regression | Quantitative Methods for Geographers" />
  
  <meta name="twitter:description" content="This is the script of the course ‘Quantitative Methods for Geographers’ run at the Geography Department of Humboldt-Universität zu Berlin." />
  

<meta name="author" content="Tobias Krueger" />


<meta name="date" content="2020-10-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="math.html"/>
<link rel="next" href="categorical-vars.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Quantitative Methods for Geographers</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="orga.html"><a href="orga.html"><i class="fa fa-check"></i><b>1</b> Organisational matters</a><ul>
<li class="chapter" data-level="1.1" data-path="orga.html"><a href="orga.html#motivating-example"><i class="fa fa-check"></i><b>1.1</b> Motivating example</a></li>
<li class="chapter" data-level="1.2" data-path="orga.html"><a href="orga.html#topics"><i class="fa fa-check"></i><b>1.2</b> Topics</a></li>
<li class="chapter" data-level="1.3" data-path="orga.html"><a href="orga.html#format"><i class="fa fa-check"></i><b>1.3</b> Format</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>2</b> Mathematical preliminaries</a><ul>
<li class="chapter" data-level="2.1" data-path="math.html"><a href="math.html#logarithm-and-exponentiation"><i class="fa fa-check"></i><b>2.1</b> Logarithm and exponentiation</a></li>
<li class="chapter" data-level="2.2" data-path="math.html"><a href="math.html#centring-and-standardisation"><i class="fa fa-check"></i><b>2.2</b> Centring and standardisation</a></li>
<li class="chapter" data-level="2.3" data-path="math.html"><a href="math.html#derivatives"><i class="fa fa-check"></i><b>2.3</b> Derivatives</a></li>
<li class="chapter" data-level="2.4" data-path="math.html"><a href="math.html#matrix-algebra"><i class="fa fa-check"></i><b>2.4</b> Matrix algebra</a><ul>
<li class="chapter" data-level="2.4.1" data-path="math.html"><a href="math.html#simple-matrix-operations"><i class="fa fa-check"></i><b>2.4.1</b> Simple matrix operations</a></li>
<li class="chapter" data-level="2.4.2" data-path="math.html"><a href="math.html#matrix-multiplication"><i class="fa fa-check"></i><b>2.4.2</b> Matrix multiplication</a></li>
<li class="chapter" data-level="2.4.3" data-path="math.html"><a href="math.html#matrix-division-inverse-of-a-matrix-identity-matrix"><i class="fa fa-check"></i><b>2.4.3</b> Matrix division, inverse of a matrix, identity matrix</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="math.html"><a href="math.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a><ul>
<li class="chapter" data-level="" data-path="math.html"><a href="math.html#exercise-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="math.html"><a href="math.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="math.html"><a href="math.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lin-reg.html"><a href="lin-reg.html"><i class="fa fa-check"></i><b>3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="lin-reg.html"><a href="lin-reg.html#motivation"><i class="fa fa-check"></i><b>3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2" data-path="lin-reg.html"><a href="lin-reg.html#the-linear-model"><i class="fa fa-check"></i><b>3.2</b> The linear model</a></li>
<li class="chapter" data-level="3.3" data-path="lin-reg.html"><a href="lin-reg.html#description-versus-prediction"><i class="fa fa-check"></i><b>3.3</b> Description versus prediction</a></li>
<li class="chapter" data-level="3.4" data-path="lin-reg.html"><a href="lin-reg.html#linear-regression"><i class="fa fa-check"></i><b>3.4</b> Linear Regression</a></li>
<li class="chapter" data-level="3.5" data-path="lin-reg.html"><a href="lin-reg.html#significance-of-regression"><i class="fa fa-check"></i><b>3.5</b> Significance of regression</a></li>
<li class="chapter" data-level="3.6" data-path="lin-reg.html"><a href="lin-reg.html#confidence-in-parameter-estimates"><i class="fa fa-check"></i><b>3.6</b> Confidence in parameter estimates</a></li>
<li class="chapter" data-level="3.7" data-path="lin-reg.html"><a href="lin-reg.html#goodness-of-fit"><i class="fa fa-check"></i><b>3.7</b> Goodness of fit</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="categorical-vars.html"><a href="categorical-vars.html"><i class="fa fa-check"></i><b>4</b> Categorical variables</a><ul>
<li class="chapter" data-level="4.1" data-path="categorical-vars.html"><a href="categorical-vars.html#example-one"><i class="fa fa-check"></i><b>4.1</b> Example one</a></li>
<li class="chapter" data-level="4.2" data-path="categorical-vars.html"><a href="categorical-vars.html#example-two"><i class="fa fa-check"></i><b>4.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-lin-reg.html"><a href="multiple-lin-reg.html"><i class="fa fa-check"></i><b>5</b> Multiple linear regression</a></li>
<li class="chapter" data-level="6" data-path="ml-bayes.html"><a href="ml-bayes.html"><i class="fa fa-check"></i><b>6</b> Probabilistic underpinnings</a></li>
<li class="chapter" data-level="7" data-path="glms.html"><a href="glms.html"><i class="fa fa-check"></i><b>7</b> Generalised Linear Models (GLMs)</a></li>
<li class="chapter" data-level="8" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>8</b> Multivariate methods</a><ul>
<li class="chapter" data-level="8.1" data-path="multivariate.html"><a href="multivariate.html#cluster-analysis"><i class="fa fa-check"></i><b>8.1</b> Cluster analysis</a></li>
<li class="chapter" data-level="8.2" data-path="multivariate.html"><a href="multivariate.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>8.2</b> Principal Component Analysis (PCA)</a></li>
<li class="chapter" data-level="8.3" data-path="multivariate.html"><a href="multivariate.html#multivariate-anova-manova"><i class="fa fa-check"></i><b>8.3</b> Multivariate ANOVA (MANOVA)</a></li>
<li class="chapter" data-level="8.4" data-path="multivariate.html"><a href="multivariate.html#discriminant-function-analysis-dfa"><i class="fa fa-check"></i><b>8.4</b> Discriminant Function Analysis (DFA)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative Methods for Geographers</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lin_reg" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Linear regression</h1>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">3.1</span> Motivation</h2>
<p>The questions we wish to answer with linear regression are of the kind depicted in Figure <a href="orga.html#fig:motivation">1.1</a>: What drives spatial variation in annual average precipitation and annual average temperature? In the case of precipitation the drivers seem to be continentality and elevation, while temperature seems to be dominantly controlled by elevation only. Linear regression puts this question as a problem of modelling a response variable with one or more predictor variables, while the relationship between the two is linear in its parameters.</p>
</div>
<div id="the-linear-model" class="section level2">
<h2><span class="header-section-number">3.2</span> The linear model</h2>
<p>A <strong>linear model</strong> is generally of the form:</p>
<p><span class="math display" id="eq:linmod">\[\begin{equation}
y = \beta_0 + \sum_{j+1}^{p}\beta_j \cdot x_j + \epsilon
\tag{3.1}
\end{equation}\]</span>
In this equation, <span class="math inline">\(y\)</span> is the <strong>response variable</strong> (also called dependent or output variable), <span class="math inline">\(x_j\)</span> are the <strong>predictor variables</strong> (also called independent, explanatory, input variables or covariates), <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_p\)</span> are the <strong>parameters</strong> and <span class="math inline">\(\epsilon\)</span> is the <strong>residual</strong>, i.e. that part of the response which remains unexplained by the predictors.</p>
<p>In the case of one predictor, which has come to be known as <strong>linear regression</strong>, the linear model is:</p>
<p><span class="math display" id="eq:linmodsingle">\[\begin{equation}
y = \beta_0 + \beta_1 \cdot x + \epsilon
\tag{3.2}
\end{equation}\]</span>
It can be visualised as a line, with <span class="math inline">\(\beta_0\)</span> being the <strong>intercept</strong>, where the line intersects the vertical axis (<span class="math inline">\(x=0\)</span>), and <span class="math inline">\(\beta_1\)</span> being the <strong>slope</strong> of the line (Figure <a href="lin-reg.html#fig:linreggraph">3.1</a>). Note, the point <span class="math inline">\(\left(\bar{x},\bar{y}\right)\)</span>, the centroid of the data, lies always on the line.</p>
<div class="figure" style="text-align: center"><span id="fig:linreggraph"></span>
<img src="figs/linreggraph.png" alt="Linear model with one predictor variable (linear regression)" width="80%" />
<p class="caption">
Figure 3.1: Linear model with one predictor variable (linear regression)
</p>
</div>
<p>Linear means linear in the model parameters, not (necessarily) in the predictor variables. With this in mind, consider the following five models. Which are linear models, which are non-linear models? (Q1)<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<p><span class="math display" id="eq:Q1model1">\[\begin{equation}
y = \beta_0 + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \epsilon
\tag{3.3}
\end{equation}\]</span>
<span class="math display" id="eq:Q1model2">\[\begin{equation}
y = \beta_0 + \beta_1 \cdot x_1^{\beta_2} + \epsilon
\tag{3.4}
\end{equation}\]</span>
<span class="math display" id="eq:Q1model3">\[\begin{equation}
y = \beta_0 + \beta_1 \cdot x_1^3 + \beta_2 \cdot x_1 \cdot x_2 + \epsilon
\tag{3.5}
\end{equation}\]</span>
<span class="math display" id="eq:Q1model4">\[\begin{equation}
y = \beta_0 + \exp(\beta_1 \cdot x_1) + \beta_2 \cdot x_2 + \epsilon
\tag{3.6}
\end{equation}\]</span>
<span class="math display" id="eq:Q1model5">\[\begin{equation}
y = \beta_0 + \beta_1 \cdot \log x_1 + \beta_2 \cdot x_2 + \epsilon
\tag{3.7}
\end{equation}\]</span></p>
<p>We can also write the linear model equation with the data points index by <span class="math inline">\(i\)</span> for <span class="math inline">\(i=1,\ldots,n\)</span>:</p>
<p><span class="math display" id="eq:linmodi">\[\begin{equation}
y_i = \beta_0 + \sum_{j=1}^{p}\beta_j \cdot x_{ij} + \epsilon_i
\tag{3.8}
\end{equation}\]</span>
These data points could be repeat measurements in time or in space.</p>
<p>We can also write the model more compactly in matrix formulation:</p>
<p><span class="math display" id="eq:linmodmatrix">\[\begin{equation}
y = \mathbf{X} \cdot \beta + \epsilon
\tag{3.9}
\end{equation}\]</span></p>
<p>With <span class="math inline">\(y = \begin{pmatrix} y_1\\ y_2\\ y_3 \end{pmatrix}\)</span>, <span class="math inline">\(\beta = \begin{pmatrix} \beta_0\\ \beta_1\\ \beta_2\\ \beta_3 \end{pmatrix}\)</span>, <span class="math inline">\(\epsilon = \begin{pmatrix} \epsilon_1\\ \epsilon_2\\ \epsilon_3 \end{pmatrix}\)</span> and <span class="math inline">\(\mathbf{X} = \begin{pmatrix} 1 &amp; x_{11} &amp; x_{12} &amp; x_{13}\\ 1 &amp; x_{21} &amp; x_{22} &amp; x_{23}\\ 1 &amp; x_{31} &amp; x_{32} &amp; x_{33} \end{pmatrix}\)</span>, the latter being the <strong>design matrix</strong> which summarises the predictor data.</p>
<p>When we talk about the linear model, the response variable is always continuous, while the predictor variables can be continuous, categorical or mixed. In principle, each of these variants can be treated mathematically in the same way, e.g. all can be analysed using the <em>lm</em> function in R. However, historically different names have been established for these variants, which are worth mentioning here to avoid confusion (Tables <a href="lin-reg.html#tab:variants1">3.1</a> and <a href="lin-reg.html#tab:variants2">3.2</a>).</p>
<table>
<caption><span id="tab:variants1">Table 3.1: </span> Historical names for the variants of the linear model, depending on whether the predictors are continuous, categorical or mixed. The response is always continuous.</caption>
<thead>
<tr class="header">
<th align="center">Continuous</th>
<th align="center">Categorical</th>
<th align="center">Mixed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Regression</td>
<td align="center">Analysis of variance<br>(ANOVA)</td>
<td align="center">Analysis of covariance<br>(ANCOVA)</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:variants2">Table 3.2: </span> For the case of regression, different variants with different historical names can be distinguished again, depending on whether we have one or more predictors and one or more responses.</caption>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">1 predictor variable</th>
<th align="center">&gt;1 predictor variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>1 response variable</strong></td>
<td align="center">Regression</td>
<td align="center">Multiple regression</td>
</tr>
<tr class="even">
<td align="center"><strong>&gt;1 response variables</strong></td>
<td align="center">Multivariate regression</td>
<td align="center">Multivariate regression</td>
</tr>
</tbody>
</table>
</div>
<div id="description-versus-prediction" class="section level2">
<h2><span class="header-section-number">3.3</span> Description versus prediction</h2>
<p>[…]</p>
</div>
<div id="linear-regression" class="section level2">
<h2><span class="header-section-number">3.4</span> Linear Regression</h2>
</div>
<div id="significance-of-regression" class="section level2">
<h2><span class="header-section-number">3.5</span> Significance of regression</h2>
</div>
<div id="confidence-in-parameter-estimates" class="section level2">
<h2><span class="header-section-number">3.6</span> Confidence in parameter estimates</h2>
</div>
<div id="goodness-of-fit" class="section level2">
<h2><span class="header-section-number">3.7</span> Goodness of fit</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The answer can be found at the end of this script.<a href="lin-reg.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="math.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="categorical-vars.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
